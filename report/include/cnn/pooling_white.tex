\resizebox{\textwidth}{!}{
	\begin{tikzpicture}[node distance=1cm,box/.style = {draw,rectangle, minimum width=1cm,minimum height=1cm}]]
		\node[box,minimum width=4cm,minimum height=4cm] (in) {};
		\node[draw,rectangle,fill=black,rotate=-45,minimum width=4cm,minimum height=0.2cm] (feature) at (in) {};
		\node[node distance=2.5cm,below of=in] (inlabel) {Input Feature Map};

		\node[box,minimum width=2cm,minimum height=2cm,right of=in,xshift=4cm,yshift=1.5cm] (out1) {};
		\node[node distance=1.5cm,below of=out1] (out1label) {After Max Pooling};

		\node[box,,minimum width=2cm,minimum height=2cm,right of=in,xshift=4cm,yshift=-1.5cm] (out2) {};
		\node[node distance=1.5cm,below of=out2] (out2label) {After Avg Pooling};

		\node[draw,rectangle,fill=black!50,rotate=-45,minimum width=2cm,minimum height=0.15cm,inner sep=0pt] (feature2) at (out2) {};

		\draw[-latex,thick] ($(in.east)+(0,1.5cm)$) -- (out1);
		\draw[-latex,thick]  ($(in.east)+(0,-1.5cm)$) -- (out2);

		\node[box,fill=blue!50, node distance=9cm,right of=in,yshift=1.5cm] (n1) {0};
		\node[box,fill=blue!50,right of=n1] (n2) {255};
		\node[box,fill=yellow!50,right of=n2] (n3) {255};
		\node[box,fill=yellow!50,right of=n3] (n4) {255};

		\node[box,fill=blue!50,below of=n1] (n5) {255};
		\node[box,fill=blue!50,right of=n5] (n6) {0};
		\node[box,fill=yellow!50,right of=n6] (n7) {255};
		\node[box,fill=yellow!50,right of=n7] (n8) {255};

		\node[box,fill=green!50,below of=n5] (n9) {255};
		\node[box,fill=green!50,right of=n9] (n10) {255};
		\node[box,fill=red!50,right of=n10] (n11) {0};
		\node[box,fill=red!50,right of=n11] (n12) {255};

		\node[box,fill=green!50,below of=n9] (n13) {255};
		\node[box,fill=green!50,right of=n13] (n14) {255};
		\node[box,fill=red!50,right of=n14] (n15) {255};
		\node[box,fill=red!50,right of=n15] (n16) {0};

		\node[box,fill=blue!50,right of=n1,xshift=5cm,yshift=0.5cm] (a1) {255};
		\node[box,fill=yellow!50,right of=a1] (a2) {255};
		\node[box,fill=green!50,below of=a1] (a3) {255};
		\node[box,fill=red!50,below of=a2] (a4) {255};

		\node[box,fill=green!50,right of=n13,xshift=5cm,yshift=-0.5cm] (b1) {128};
		\node[box,fill=red!50,right of=b1] (b2) {255};
		\node[box,fill=blue!50,above of=b1] (b3) {255};
		\node[box,fill=yellow!50,above of=b2] (b4) {128};

		\draw[-latex,thick] ($(n8.south east)+(0,1.5cm)$) -- (a3.north west);
		\draw[-latex,thick] ($(n8.south east)+(0,-1.5cm)$) -- (b1.north west);
\end{tikzpicture}}


